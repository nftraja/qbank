<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>QBank â€“ Category</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/style.css">
</head>

<body>

<div class="drawer-overlay" id="overlay"></div>

<div class="drawer" id="drawer">
  <a href="/">ğŸ  Home</a>
  <a href="/categories.html">ğŸ“‚ All Categories</a>
</div>

<header class="app-header">
  <button class="menu-btn" id="menuBtn">â˜°</button>
  <div class="logo" id="categoryTitle">Category</div>
</header>

<main class="main-content">

  <div class="glass-card">
    <div class="card-title" id="categoryHeading">Loading...</div>
    <div class="card-desc">
      Verified official platforms and structured academic resources.
    </div>
  </div>

  <div id="dataContainer"></div>

</main>

<script src="/app.js"></script>

<script>
const params = new URLSearchParams(window.location.search);
const category = params.get("cat");
const container = document.getElementById("dataContainer");

if(category){

  const formatted = category.replaceAll("-", " ");
  document.getElementById("categoryTitle").innerText = formatted;
  document.getElementById("categoryHeading").innerText = formatted;

  fetch("./data/platforms.json")
    .then(res => res.json())
    .then(data => {

      const filtered = data.filter(item =>
        item.category.trim().toLowerCase() === category.trim().toLowerCase()
      );

      if(filtered.length === 0){
        container.innerHTML = `
          <div class="glass-card">
            <div class="card-title">No Platforms Found</div>
            <div class="card-desc">Category mapping mismatch.</div>
          </div>
        `;
        return;
      }

      container.innerHTML = filtered.map(item => `
        <div class="list-card">
          <div class="list-title">${item.name}</div>
          <div class="list-desc">${item.description}</div>
          <a href="${item.link}" target="_blank" class="btn">Visit</a>
        </div>
      `).join("");

    })
    .catch(err => {
      container.innerHTML = `
        <div class="glass-card">
          <div class="card-title">Data Load Failed</div>
        </div>
      `;
      console.error(err);
    });
}
</script>

</body>
</html>