<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QBank Category</title>
<link rel="stylesheet" href="/style.css">
</head>

<body>

<!-- OVERLAY -->
<div class="drawer-overlay" id="overlay"></div>

<!-- DRAWER -->
<div class="drawer" id="drawer">
  <a href="/">ğŸ  Home</a>
  <a href="/categories.html">ğŸ“‚ All Categories</a>
</div>

<!-- HEADER -->
<header class="app-header">
  <button class="menu-btn" id="menuBtn">â˜°</button>
  <div class="logo" id="categoryTitle">Category</div>
</header>

<!-- MAIN -->
<main class="main-content">

  <div class="glass-card">
    <div class="card-title" id="categoryHeading">Loading...</div>
    <div class="card-desc">
      Verified official platforms and structured academic resources.
    </div>
  </div>

  <div id="dataContainer"></div>

</main>

<!-- BOTTOM NAV -->
<nav class="bottom-nav">
  <a href="/" class="bottom-item"><span>ğŸ </span><small>Home</small></a>
  <a href="/categories.html" class="bottom-item active"><span>ğŸ“‚</span><small>Categories</small></a>
</nav>

<script src="/app.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function(){

  const params = new URLSearchParams(window.location.search);
  let category = params.get("cat");

  if(!category){
    document.getElementById("categoryHeading").innerText = "Invalid Category";
    return;
  }

  // Normalize URL category
  category = category.toLowerCase().trim();

  document.getElementById("categoryTitle").innerText = category;
  document.getElementById("categoryHeading").innerText = category;

  fetch("/platforms.json")
    .then(res => {
      if(!res.ok) throw new Error("Fetch failed");
      return res.json();
    })
    .then(data => {

      const filtered = data.filter(item =>
        item.category &&
        item.category.toLowerCase().trim() === category
      );

      if(filtered.length === 0){
        document.getElementById("dataContainer").innerHTML =
          '<div class="list-card"><div class="list-title">No Platforms Found</div></div>';
        return;
      }

      document.getElementById("dataContainer").innerHTML =
        filtered.map(item => `
          <div class="list-card">
            <div class="list-title">${item.name}</div>
            <div class="list-desc">${item.description}</div>
            <a href="${item.link}" target="_blank" class="btn">Visit</a>
          </div>
        `).join("");

    })
    .catch((err) => {
      console.error("JSON Load Error:", err);
      document.getElementById("dataContainer").innerHTML =
        '<div class="list-card"><div class="list-title">Data Load Failed</div></div>';
    });

});
</script>

</body>
</html>